<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  <meta name="viewport" content="width=device-width,initial-scale=1">
  <title>CIV7 Tracker · Civilizations</title>
  <link rel="icon" type="image/x-icon" href="favicon.ico">
  <link rel="icon" type="image/png" sizes="32x32" href="favicon-32x32.png">
  <link rel="icon" type="image/png" sizes="16x16" href="favicon-16x16.png">
  <link rel="apple-touch-icon" sizes="180x180" href="apple-touch-icon.png">
  <link rel="manifest" href="site.webmanifest">
  <meta name="theme-color" content="#001a33">
  <meta name="description" content="Edit Civilization VII Civilizations data.">
  <meta property="og:title" content="CIV7 Tracker · Civilizations">
  <meta property="og:description" content="Maintain Civilization VII Civilizations data.">
  <meta property="og:url" content="https://sjones321.github.io/civ7-tracker/data-civilizations.html">
  <meta property="og:image" content="https://sjones321.github.io/civ7-tracker/img/og-card.png">
  <style>
    body { font-family: system-ui, -apple-system, Segoe UI, Roboto, sans-serif; margin:0; background:#f5f7fa; color:#102542; }
    header { display:flex; gap:12px; align-items:center; padding:12px 16px; background:#001a33; color:#fff; }
    header h1 { margin:0; font-size:1.5rem; }
    nav { background:#0d2b4d; padding:8px 16px; }
    nav a { color:#e6f1ff; margin-right:12px; text-decoration:none; font-weight:600; }
    nav a[aria-current="page"] { text-decoration:underline; }
    main { padding:16px; max-width: 1100px; margin:0 auto; }
    h1, h2, h3 { color:#001a33; }
    .layout { display:flex; flex-wrap:wrap; gap:24px; margin-bottom:24px; }
    .panel { flex:1 1 320px; background:#fff; border-radius:8px; box-shadow:0 1px 3px rgba(0,0,0,0.1); padding:16px; }
    table { width:100%; border-collapse:collapse; }
    th, td { border-bottom:1px solid #d9e2ec; padding:8px; text-align:left; vertical-align:top; }
    th { font-weight:600; }
    caption { text-align:left; font-weight:600; margin-bottom:8px; }
    form label { display:block; font-weight:600; margin-top:12px; }
    form small { display:block; margin-top:4px; color:#52606d; }
    form input[type="text"],
    form input[type="number"],
    form textarea,
    form select { width:100%; padding:8px; border:1px solid #bcccdc; border-radius:4px; font-size:1rem; }
    form textarea { min-height:72px; }
    .checkbox-label { display:flex; align-items:center; gap:8px; margin-top:12px; font-weight:600; }
    .form-actions { margin-top:16px; display:flex; gap:12px; flex-wrap:wrap; }
    button { cursor:pointer; border-radius:4px; border:1px solid transparent; padding:8px 14px; font-size:0.95rem; }
    button.primary { background:#0077cc; color:#fff; }
    button.secondary { background:#fff; border-color:#6c8aa4; color:#0d2b4d; margin-left:8px; }
    button.danger { background:#fff; border-color:#c62828; color:#c62828; margin-left:8px; }
    .status-region { margin:16px 0; padding:12px; border-radius:6px; background:#eef2f7; border:1px solid #cbd5e0; min-height:48px; }
    .status-region[data-tone="success"] { background:#e3f9e5; border-color:#2ecc71; color:#1c7c3a; }
    .status-region[data-tone="error"] { background:#fde8e8; border-color:#f56565; color:#9b2c2c; }
    .icon-display { display:inline-block; min-width:1.5rem; margin-right:8px; text-align:center; }
    .icon-display img { width:40px; height:40px; object-fit:contain; border:1px solid #bcccdc; border-radius:4px; padding:2px; background:#fff; }
    #civ-icon-preview { margin-top:8px; min-height:60px; display:flex; align-items:center; justify-content:flex-start; }
    #civ-icon-preview img { max-width:72px; max-height:72px; border:1px solid #bcccdc; border-radius:4px; padding:4px; background:#fff; }
    #civ-icon-preview span { color:#52606d; }
    #new-civ { margin-top:12px; }
    .data-tools textarea { margin-top:12px; width:100%; padding:8px; border:1px solid #bcccdc; border-radius:4px; font-family:monospace; font-size:0.9rem; background:#f8fafc; color:#102542; }
    .building-quarter-toggle { margin-top:16px; padding:12px; background:#f8fafc; border:1px solid #d9e2ec; border-radius:4px; }
    .building-fields, .quarter-fields { margin-top:8px; }
    .quarter-fields { display:none; }
    .autocomplete-dropdown { 
      position: absolute !important;
      background: #fff !important;
      border: 1px solid #bcccdc !important;
      border-radius: 4px !important;
      box-shadow: 0 2px 8px rgba(0,0,0,0.15) !important;
      max-height: 200px !important;
      overflow-y: auto !important;
      z-index: 10000 !important;
      visibility: visible !important;
    }
    .autocomplete-item {
      padding: 8px 12px !important;
      cursor: pointer !important;
      border-bottom: 1px solid #eef2f7 !important;
      color: #102542 !important;
    }
    .autocomplete-item:hover,
    .autocomplete-item[style*="background-color: rgb(240, 240, 240)"] {
      background-color: #e6f1ff !important;
    }
    .autocomplete-item:last-child {
      border-bottom: none !important;
    }
    footer { text-align:center; padding:24px; color:#52606d; font-size:0.9rem; }
    @media (max-width: 768px) {
      header { flex-direction:column; align-items:flex-start; }
      nav { display:flex; flex-wrap:wrap; gap:12px; }
    }
  </style>
  <script>
    (function(){
      function renderBadge() {
        var els = document.querySelectorAll('[data-version-badge]');
        if (!els.length) {
          return;
        }
        fetch('docs/site.json', { cache: 'no-store' })
          .then(function (r) {
            if (!r.ok) {
              throw new Error('HTTP ' + r.status);
            }
            return r.json();
          })
          .then(function (data) {
            els.forEach(function (el) {
              el.classList.add('version-badge');
              el.textContent = 'v' + data.version + ' · ' + data.buildDate;
              el.setAttribute('title', 'Version ' + data.version + ' built ' + data.buildDate);
            });
          })
          .catch(function (err) {
            els.forEach(function (el) {
              el.classList.add('version-badge');
              el.textContent = 'version unavailable';
              el.title = err && err.message ? err.message : 'version fetch failed';
            });
          });
      }
      if (document.readyState === 'loading') {
        document.addEventListener('DOMContentLoaded', renderBadge);
      } else {
        renderBadge();
      }
    })();
  </script>
  <style>
    .version-badge { display:inline-block; font:12px/1.2 system-ui,Segoe UI,Roboto,Arial; border:1px solid #ccc; border-radius:6px; padding:2px 6px; vertical-align:middle; background:#fff; color:#001a33; }
  </style>
</head>
<body>
  <header>
    <h1>CIV7 Tracker</h1>
    <span data-version-badge></span>
  </header>
  <nav>
    <a href="./">Home</a>
    <a href="data-wonders.html">World Wonders Editor</a>
    <a href="data-leaders.html">Leaders Editor</a>
    <a href="data-civilizations.html" aria-current="page">Civilizations Editor</a>
    <a href="data-tech-civics.html">Tech/Civics Editor</a>
    <a href="data-natural-wonders.html">Natural Wonders Editor</a>
    <a href="data-mementos.html">Mementos Editor</a>
    <a href="data-social-policies.html">Social Policies Editor</a>
  </nav>
  <main>
    <h1>Civilizations Data Editor</h1>
    <p>Manage Civilization VII Civilizations. Track unique units, buildings, quarters, civics, and effects for each civilization.</p>

    <section class="status-region" aria-live="polite" id="status-message" role="status" data-tone="info">Ready to add a new Civilization.</section>

    <div class="layout">
      <section class="panel" aria-labelledby="civs-list-heading">
        <h2 id="civs-list-heading">Current Civilizations</h2>
        <table>
          <caption>Saved Civilizations</caption>
          <thead>
            <tr>
              <th scope="col">Name</th>
              <th scope="col">Age</th>
              <th scope="col">Icon &amp; Actions</th>
            </tr>
          </thead>
          <tbody id="civs-table-body"></tbody>
        </table>
        <button type="button" class="primary" id="new-civ">New Civilization</button>
      </section>

      <section class="panel" aria-labelledby="editor-heading">
        <h2 id="editor-heading">Civilization Details</h2>
        <form id="civ-form" novalidate>
          <label for="civ-id">ID</label>
          <input id="civ-id" name="id" type="text" required autocomplete="off" aria-describedby="id-help">
          <small id="id-help">Use a unique identifier such as <code>rome</code> or <code>civ:rome</code>.</small>

          <label for="civ-name">Name</label>
          <input id="civ-name" name="name" type="text" required autocomplete="off">

          <label for="civ-age">Age</label>
          <select id="civ-age" name="age" required>
            <option value="" disabled selected>Select age</option>
            <option value="Antiquity">Antiquity</option>
            <option value="Exploration">Exploration</option>
            <option value="Modern">Modern</option>
          </select>

          <label for="civ-icon-url">Icon URL</label>
          <input id="civ-icon-url" name="iconUrl" type="text" autocomplete="off" placeholder="Paste an image URL or use upload">
          <input id="civ-icon-file" name="iconFile" type="file" accept="image/*">
          <div id="civ-icon-preview" aria-live="polite" aria-label="Icon preview" role="img"></div>
          <small>Icon previews come from the provided URL or uploaded image.</small>

          <h3>Unique Units</h3>
          <label for="civ-unit-military-1">Military Unit 1</label>
          <input id="civ-unit-military-1" name="unitMilitary1" type="text" autocomplete="off" placeholder="Enter unit name...">

          <label for="civ-unit-military-2">Military Unit 2 (Optional)</label>
          <input id="civ-unit-military-2" name="unitMilitary2" type="text" autocomplete="off" placeholder="Enter unit name...">

          <label for="civ-unit-civilian">Civilian/Commander Unit</label>
          <input id="civ-unit-civilian" name="unitCivilian" type="text" autocomplete="off" placeholder="Enter unit name...">
          <small>Unique units for this civilization</small>

          <h3>Unique Building/Quarter</h3>
          <div class="building-quarter-toggle">
            <label class="checkbox-label">
              <input type="checkbox" id="is-quarter" name="isQuarter">
              This is a Quarter (2 buildings)
            </label>

            <div class="building-fields" id="building-fields">
              <label for="civ-building">Unique Building</label>
              <input id="civ-building" name="building" type="text" autocomplete="off" placeholder="Enter building name...">
            </div>

            <div class="quarter-fields" id="quarter-fields">
              <label for="civ-quarter-name">Quarter Name</label>
              <input id="civ-quarter-name" name="quarterName" type="text" autocomplete="off" placeholder="Enter quarter name...">

              <label for="civ-quarter-building-1">Building 1</label>
              <input id="civ-quarter-building-1" name="quarterBuilding1" type="text" autocomplete="off" placeholder="Enter building name...">

              <label for="civ-quarter-building-2">Building 2</label>
              <input id="civ-quarter-building-2" name="quarterBuilding2" type="text" autocomplete="off" placeholder="Enter building name...">
            </div>
          </div>
          <small>Unique building or quarter (combination of 2 buildings)</small>

          <h3>Effects</h3>
          <label>Civilization Bonuses</label>
          <div id="civ-effects-container">
            <!-- Effects will be added dynamically here -->
          </div>
          <button type="button" class="secondary" id="add-effect-button">+ Add Effect</button>
          <small>List of passive bonuses and abilities</small>

          <h3>Unique Civics</h3>
          <label>Civilization-Specific Civics</label>
          <div id="civ-civics-container">
            <!-- Civics will be added dynamically here -->
          </div>
          <button type="button" class="secondary" id="add-civic-button">+ Add Unique Civic</button>
          <small>Civics that are unique to this civilization</small>

          <h3>Associated Wonder</h3>
          <label for="civ-wonder">Wonder (Optional)</label>
          <input id="civ-wonder" name="wonder" type="text" autocomplete="off" placeholder="Start typing wonder name...">
          <small>The wonder that gives this civ a +30% production bonus</small>

          <div class="form-actions">
            <button type="submit" class="primary">Save Civilization</button>
            <button type="button" class="secondary" id="reset-form">Reset</button>
          </div>
        </form>
      </section>
    </div>

    <section class="panel data-tools" aria-labelledby="data-tools-heading">
      <h2 id="data-tools-heading">Import / Export</h2>
      <p>Copy data to share or paste JSON to replace your current Civilizations.</p>
      <div class="form-actions">
        <button type="button" class="primary" id="export-button">Export JSON</button>
        <button type="button" class="secondary" id="import-button">Import JSON</button>
        <button type="button" class="danger" id="clear-all">Delete All Civilizations</button>
      </div>
      <textarea id="json-data" aria-label="Civilizations JSON" placeholder="Paste Civilizations JSON here" spellcheck="false" rows="8"></textarea>
    </section>
  </main>
  <footer>© CIV7 Tracker</footer>
  <!-- Load Supabase library first -->
  <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
  <!-- Load your config (with API keys) -->
  <script src="js/supabase-config.js"></script>
  <!-- Load the store that uses Supabase -->
  <script src="js/store-supabase.js"></script>
  <!-- Load autocomplete component -->
  <script src="js/autocomplete.js"></script>
  <script src="js/data-civilizations.js"></script>
  <script src="js/main.js"></script>
</body>
</html>

