<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8">
<meta name="viewport" content="width=device-width,initial-scale=1">
<title>Civ7 Debug Console</title>
<style>
  :root{--bg:#0f1216;--panel:#171b21;--text:#e6edf3;--muted:#9aa4b2;--border:#242a33;--accent:#4aa3ff}
  *{box-sizing:border-box} body{margin:0;background:var(--bg);color:var(--text);font:14px/1.45 ui-sans-serif,system-ui}
  .wrap{max-width:1200px;margin:0 auto;padding:16px}
  .card{background:var(--panel);border:1px solid var(--border);border-radius:12px;padding:14px;margin-bottom:12px}
  .row{display:flex;gap:8px;align-items:center;flex-wrap:wrap}
  input,button{background:#0b0f14;border:1px solid var(--border);border-radius:10px;color:var(--text);padding:8px 10px}
  button{background:var(--accent);color:#001329;font-weight:800;cursor:pointer}
  iframe{width:100%;height:600px;background:#0b0f14;border:1px solid var(--border);border-radius:12px}
  pre{white-space:pre-wrap;background:#0b0f14;border:1px solid var(--border);padding:10px;border-radius:10px;max-height:320px;overflow:auto}
</style>
</head>
<body>
<div class="wrap">
  <h1>Civ7 Debug Console</h1>

  <div class="card row">
    <label>Target (same origin):</label>
    <input id="url" value="index.html" style="min-width:400px">
    <button id="open">Open</button>
    <button id="inject">Inject Core+Overlay</button>
    <button id="run">Ask page to run (postMessage)</button>
    <span id="status" style="opacity:.8"></span>
  </div>

  <div class="card">
    <iframe id="frame" src=""></iframe>
  </div>

  <div class="card">
    <h2>Last Report</h2>
    <pre id="report"></pre>
  </div>
</div>

<script>
(function(){
  const $=id=>document.getElementById(id);
  const status=$('status'), rep=$('report'), frame=$('frame');
  function setStatus(t){ status.textContent = t; }
  $('open').onclick = ()=>{ frame.src=$('url').value.trim(); setStatus('loadingâ€¦'); };
  frame.addEventListener('load', ()=> setStatus('ready'));
  $('inject').onclick = ()=>{
    const w = frame.contentWindow; const d = w.document;
    try{
      const core = d.createElement('script'); core.src='civ7_debug_core.js'; d.head.appendChild(core);
      const overlay = d.createElement('script'); overlay.src='civ7_debug_overlay.js'; d.head.appendChild(overlay);
      setStatus('injected core+overlay (page overlay will run itself)');
    }catch(e){ setStatus('inject failed: '+e); }
  };
  window.addEventListener('message', ev=>{
    if(ev.data && ev.data.__CIV7_PAGE_REPORT){ rep.textContent = JSON.stringify(ev.data.__CIV7_PAGE_REPORT, null, 2); }
  });
  $('run').onclick = ()=>{
    try{ frame.contentWindow.postMessage({__CIV7_CMD:'RUN_CIV7_DEBUG'}, '*'); setStatus('run posted'); }catch(e){ setStatus('post failed: '+e); }
  };
})();
</script>
</body>
</html>
